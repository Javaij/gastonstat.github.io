<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  
  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      How to read files ... one line at a time &middot; Gaston Sanchez
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body>

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href="/">
          Gaston Sanchez
        </a>
      </h1>
      <p class="lead"></p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/">Home</a>

      

      
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/blog/">Blog</a>
          
        
      
        
          
        
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/about/">About</a>
          
        
      
        
          
            <a class="sidebar-nav-item" href="/software/">Software</a>
          
        
      
        
          
            <a class="sidebar-nav-item" href="/teaching/">Teaching</a>
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      

      <a class="sidebar-nav-item" href="https://github.com/gastonstat" target="_blank">GitHub</a>
    </nav>

    <!-- <p><small>All contents under <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">(CC) BY-NC-SA</a> license, unless otherwise noted</small></p>
  -->
  </div>
</div>


    <div class="content container">
      <div class="post">
  <h1 class="post-title">How to read files ... one line at a time</h1>
  <span class="post-date">01 Jun 2012</span>
  <p>Imagine that we have a file (.txt, .csv, .dat, etc) and that we need to do some kind of 
process for each line, and then save the results in another file. The only problem is 
that the size of the file is so huge that it is not possible to import it directly to R.</p>

<!--more-->

<p>What can we do? We can simply read line by a line while applying the required operations 
and export the output to another file. Here&#39;s how. We need the input file (where the 
data is), and the output file (where the results will be stored). The general idea is to:</p>

<ol>
<li>Read the input file line by line</li>
<li>For each line:

<ol>
<li>Apply operations</li>
<li>Export the outcome to the output file</li>
</ol></li>
<li>Repeat steps 2.1 and 2.2</li>
</ol>

<h3>Toy example</h3>

<p>Let&#39;s say we have an <code>input_file</code> with a lot of lines. We need to apply some 
function to each line, and then export the outcome to an <code>output_file</code>. Let&#39;s 
suppose that the outcome will be stored in a vector of length 6 with the following 
elements: <code>Id</code> id number, <code>Name</code> some name, <code>Var1-Var3</code> are values for three 
variables, <code>Status</code> some label. Here&#39;s one way to do it.</p>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1"># specify output_file with column names in the first line</span>
<span class="kp">cat</span><span class="p">(</span><span class="kt">c</span><span class="p">(</span><span class="s">&quot;Id&quot;</span><span class="p">,</span> <span class="s">&quot;Name&quot;</span><span class="p">,</span> <span class="s">&quot;Var1&quot;</span><span class="p">,</span> <span class="s">&quot;Var2&quot;</span><span class="p">,</span> <span class="s">&quot;Var3&quot;</span><span class="p">,</span> <span class="s">&quot;Status&quot;</span><span class="p">),</span> <span class="s">&quot;\n&quot;</span><span class="p">,</span>
    file <span class="o">=</span> <span class="s">&quot;/path_output_file/output_file&quot;</span><span class="p">)</span>

<span class="c1"># define the location of the input file (to be read line by line)</span>
file_con <span class="o">=</span> <span class="kp">file</span><span class="p">(</span><span class="s">&quot;/path_input_file/input_file&quot;</span><span class="p">)</span>

<span class="c1"># open connection</span>
<span class="kp">open</span><span class="p">(</span>file_con<span class="p">)</span>

<span class="c1"># create a line counter</span>
count_line <span class="o">=</span> <span class="m">1</span>

<span class="c1"># let&#39;s process the data</span>
<span class="kr">while</span><span class="p">(</span><span class="kp">length</span><span class="p">(</span>oneline <span class="o">&lt;-</span> <span class="kp">readLines</span><span class="p">(</span>file_con<span class="p">,</span> n <span class="o">=</span> <span class="m">1</span><span class="p">,</span> warn <span class="o">=</span> <span class="kc">FALSE</span><span class="p">))</span> <span class="o">&gt;</span> <span class="m">0</span><span class="p">)</span>
<span class="p">{</span>
    <span class="c1"># apply some function</span>
    outcome <span class="o">=</span> myfunction<span class="p">(</span>oneline<span class="p">)</span>
    <span class="c1"># print results to output file</span>
    <span class="kp">cat</span><span class="p">(</span>outcome<span class="p">,</span> <span class="s">&quot;\n&quot;</span><span class="p">,</span> file <span class="o">=</span> <span class="s">&quot;/path_output_file/output_file&quot;</span><span class="p">,</span> append <span class="o">=</span> <span class="kc">TRUE</span><span class="p">)</span>
    <span class="c1"># increase counter</span>
    count_line <span class="o">=</span> count_line <span class="o">+</span> <span class="m">1</span>
<span class="p">}</span>

<span class="c1"># close the connection</span>
<span class="kp">close</span><span class="p">(</span>file_con<span class="p">)</span>

<span class="c1"># how many lines did we read?</span>
count_line</code></pre></div>

</div>

<hr>

<div class="previous_next">
  
    <a href="/how-to/2012/05/30/Google-line-chart/" title="Previous post">&larr; previous</a>
  
  &nbsp;&nbsp;
  
    <a href="/how-to/2012/06/08/Using-tapply-ddply-and-sqldf-for-the-same-task/" title="Next post">next &rarr;</a>
  
  <br>
  <p>
  <a class="greenbutton" href="/blog/archive/" title="an archive of all posts">See all posts</a>
  </p>
</div>
    </div>

  </body>
</html>
